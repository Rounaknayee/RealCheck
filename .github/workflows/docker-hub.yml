name: Build and Push Docker Images

on:
  push:
    branches: [ main ]  # Trigger on push to main branch
  # pull_request:
  #   branches: [ main ]  # Trigger on pull request to main branch

jobs:
  build-and-push-docker-images:

    runs-on: ubuntu-latest
    steps:

    # Checkout Code
    - name: Checkout Code
      uses: actions/checkout@v4

    # Log in to Docker Hub
    - name: Log in to Docker Hub
      uses: docker/login-action@v2
      with:
        username: ${{ secrets.DOCKER_HUB_USERNAME }}
        password: ${{ secrets.DOCKER_HUB_ACCESS_TOKEN }}

    # Build and Push Backend Image
    - name: Build Backend Docker Image
      run: docker build -t rounaknayee/realcheck-backend:latest -f ./backend/prod-backend.Dockerfile ./backend
    - name: Push Backend Docker Image
      run: docker push rounaknayee/realcheck-backend:latest

    # Build and Push Frontend Image
    - name: Build Frontend Docker Image
      run: docker build -t rounaknayee/realcheck-frontend:latest -f ./frontend/prod-frontend.Dockerfile ./frontend
    - name: Push Frontend Docker Image
      run: docker push rounaknayee/realcheck-frontend:latest